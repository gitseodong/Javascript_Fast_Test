// 동기(Synchronous)와 비동기(Asynchronous)
// - 동기: 순차적으로 코드 실행 O
// - 비동기: 순차적으로 코드 실행 X

// 콜백(Callback) 패턴 -> 콜백 지옥이 됨.
// 1, 2, 3, 4 콘솔 출력을 순서대로 보장하는 방법

let a = (callback) => {
  setTimeout(() => {
    console.log("1:", 1);
    callback();
  }, 300);
};
let b = (callback) => {
  setTimeout(() => {
    console.log("2:", 2);
    callback();
  }, 300);
};
let c = (callback) => {
  setTimeout(() => {
    console.log("3:", 3);
    callback();
  }, 300);
};
let d = () => console.log("4:", 4);

a(() => {
  b(() => {
    c(() => {
      d();
    });
  });
});

// 아래의 코드는 영화 순서가 보장되지 않는다.
let getMovies = (movieName, callback) => {
  fetch(`https://www.omdbapi.com/?apikey=7035c60c&s=${movieName}`)
    .then((res) => res.json())
    .then((res) => {
      console.log(res);
      if (callback !== undefined) callback();
    });
};

getMovies("frozen", () => {
  console.log("겨울왕국!");
});
getMovies("avengers", () => {
  console.log("어벤져스!");
});
getMovies("avatar", () => {
  console.log("아바타!");
});

// 겨울왕국->어벤져스->아바타 실행 순서 보장하기
// 그러나 코드가 들여쓰기 형태로 파고들어가서 콜백지옥이 됨.
// 콜백패턴은 오래전부터 사용해왔지만, 콜백지옥이 되는 단점이 있다.
getMovies("frozen", () => {
  console.log("겨울왕국!");
  getMovies("avengers", () => {
    console.log("어벤져스!");
    getMovies("avatar", () => {
      console.log("아바타!");
    });
  });
});
